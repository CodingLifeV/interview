<!-- TOC -->

- [计算机网络](#计算机网络)
    - [1、网络概述](#1网络概述)
        - [1、TCP协议在哪一层？IP协议在那一层？HTTP在哪一层？](#1tcp协议在哪一层ip协议在那一层http在哪一层)
        - [2、OSI七层模型](#2osi七层模型)
    - [2、运输层](#2运输层)
        - [1、讲一下TCP的连接和释放连接。](#1讲一下tcp的连接和释放连接)
        - [2、TCP有哪些应用场景](#2tcp有哪些应用场景)
        - [3、tcp为什么可靠？拥塞控制？流量控制？](#3tcp为什么可靠拥塞控制流量控制)
        - [4、tcp为什么要建立连接](#4tcp为什么要建立连接)
        - [5、阐述https三次握手，4次挥手，为什么是三次握手？](#5阐述https三次握手4次挥手为什么是三次握手)
        - [6、讲一下浏览器从接收到一个URL到最后展示出页面，经历了哪些过程。](#6讲一下浏览器从接收到一个url到最后展示出页面经历了哪些过程)
        - [7、http和https的区别](#7http和https的区别)
        - [8、https和tls机制，非对称加密，为什么tls要使用非对称加密？这里面有对称加密吗？](#8https和tls机制非对称加密为什么tls要使用非对称加密这里面有对称加密吗)
        - [8、http的请求有哪些，应答码502和504有什么区别](#8http的请求有哪些应答码502和504有什么区别)
        - [9、http1.1和1.0的区别](#9http11和10的区别)
        - [10、304状态码有什么含义？](#10304状态码有什么含义)
        - [11、TCP和UDP的区别](#11tcp和udp的区别)
        - [12、长连接、短连接，](#12长连接短连接)
    - [3、网络层](#3网络层)
        - [1、arp协议，arp攻击](#1arp协议arp攻击)
        - [2、icmp协议](#2icmp协议)
        - [3、讲一下路由器和交换机的区别？](#3讲一下路由器和交换机的区别)
    - [4、应用层](#4应用层)
        - [1、DNS寻址过程](#1dns寻址过程)
        - [2、负载均衡反向代理模式优点及缺点](#2负载均衡反向代理模式优点及缺点)

<!-- /TOC -->
# 计算机网络
## 1、网络概述
### 1、TCP协议在哪一层？IP协议在那一层？HTTP在哪一层？

TCP协议在传输层，IP协议在网络层，HTTP在应用层。

### 2、OSI七层模型
[参考1](https://blog.csdn.net/taotongning/article/details/81352985)

[参考2](https://www.jianshu.com/p/c793a279f698/)

OSI 七层模型。将网络的协议划分为 7 个层，从低到高排序是：物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。但是这个模型仅停留在理论阶段。因为该模型过于庞大、复杂，以至于无法被广泛应用。

TCP/IP 协议栈一共分为 4 个层次。从低到高依次排序是：数据链路层、网络层、传输层、应用层。

* 物理层：通过物理手段把电脑连接起来，中间的物理链接可以是光缆、电缆、双绞线、无线电波。中间传的是电信号，即010101...这些二进制位。

* 数据链路层：
  * 概念：对电信号来做分组的，确定了二进制电信号 0 和 1 的分组方式。
  * 以太网协议：一组电信号构成一个数据包，叫做“帧（Frame）”；每一帧分成两个个部分：标头（Head）和数据（Data）。“标头”包含数据包的一些说明项，比如发送者、接受者、数据类型等
  * MAC地址：每块网卡出厂时都被烧录上一个实际上唯一的MAC地址。数据包必须是从一块网卡，传送到另一块网卡，网卡的地址，就是数据包的发送地址和接受地址，也叫MAC地址
  * 广播：互联网就是由一个个局域网组成，局域网内的计算机不管是对内还是对外都是通过广播的形式发送数据。它不是把数据包准确送到接收方，而是向本网络（局域网）内所有计算机发送，让每台计算机自己判断，找到其中发送方的MAC地址，然后与自身的MAC地址进行比对，如果两者相同，说明就是要发给自己的，然后接受这个包并做出进一步的处理，否则丢弃这个包。这种发送方式就叫“广播”，主要通过分组交换机或者网络交换机进行。

* 网络层

   * 概念：引入一套新的地址，使我们能够区分哪些计算机属于同一个子网（局域网），这个套机制就叫做“网络地址”，也就是“IP地址” 。两台计算机是否遭同一个子网中，如果在，则采用广播+MAC寻址的的方式发送数据包，如果不是，则要采用“路由”的方式。
   
   * IP协议：网络地址由32个二进制位组成,习惯上，我们分成四段十进制数表示IPV4地址，从0.0.0.0到255.255.255.255。
   
     ![](https://ws1.sinaimg.cn/large/d4556b75ly1g3w1n8m0mcj20dw07ha9y.jpg)
    
     互联网上的每一台计算机，都会被分配到一个IP地址，这个地址由两部分组成，前一部分代表网络，后一部分代表主机（又称终端系统，end system）。比如，IP地址172.16.254.1，这是一个32位的地址，假定它的网络部分是前24位（172.16.254），那么主机部分就是后8位（最后的那个1）。处于同一个子网络的电脑，它们IP地址的网络部分必定是相同的，也就是说172.16.254.2应该与172.16.254.1处在同一个子网络，而后面的“2”与“1”则是同一子网内两台不同电脑（主机）的编号。

   * 子网掩码：表示子网络特征的一个参数。它在形式上等同于IP地址，也是一个32位二进制数字，它的网络部分全部为1，主机部分全部为0。比如：IP地址172.16.254.1，如果已知网络部分是前24位，主机部分是后8位，那么子网络掩码就是11111111.11111111.11111111.00000000，写成十进制就是255.255.255.0
  
  * 路由：作用是是将信息从原地址传输到目的地址，比较特殊的是，原地址和目标地址是在两个不同的子网中的。
  
  * 路由器：实现路由功能的机器，路由器连接两个或多个网络并提供路由功能。一台计算机可以有不只一个网卡，比如笔记本就有一个以太网卡和一个WiFi网卡，路由器(router)可以通俗理解为一台配备有多个网卡的专用电脑，它让网卡接入到不同的网络中。
  
  * 网关：网络层使用的路由器称为网关，通常指的网关就是路由器的IP，虽然路由器上面有MAC地址和IP地址，但它并不能通过MAC地址工作，必须通过IP寻址。因此它是工作在网络层的设备。
  
  * ARP协议：地址解析协议，用于实现从IP地址到MAC地址的映射，即询问目标IP对应的MAC地址。
  
    主机发出一个ARP包，该ARP包中包含有自己的IP地址和MAC地址。通过ARP包，主机以广播的形式询问局域网上所有的主机和路由：我是IP地址xxxx，我的MAC地址是xxxx，有人知道199.165.146.4的MAC地址吗？拥有该IP地址的主机会回复发出请求的主机：哦，我知道，这个IP地址属于我的一个NIC（网卡），它的MAC地址是xxxxxx。由于发送ARP请求的主机采取的是广播形式，并附带有自己的IP地址和MAC地址，其他的主机和路由会同时检查自己的ARP cache，如果不符合，则更新自己的ARP cache。

* 传输层
  
  * 端口号：当一个数据包从网上发送过来的时候，我们需要一个参数来区分，他到底是提供哪个进程使用的——这个参数就叫做“端口号”，他其实就是每一个使用网卡的程序的编号。端口范围0-65535，0-1023为系统占用端口

    传输层的功能，就是建立“端口到端口”之间的通信。相比之下，“网络层”的功能是建立“主机到主机"的通信

  * Socket：进程间通信分为两种：一种是主机内部（或终端内部）进程间通信；另一种是跨主机进程间通信或者网络进程间通信，也叫“socket通信”。
  
  * UDP/TCP协议：UDP和TCP协议都是传输层的协议，他们的主要作用就是在应用层的数据包标头加上端口号（或者在IP协议的数据包中插入端口号）
  
    TCP协议主要的确认机制是"三次握手，四次挥手"。

* 会话层

* 表示层

* 应用层
  
  * 概念：就是规定应用程序的数据格式。TCP协议可以为各种各样的程序传递数据，比如Email、WWW、FTP等等。那么，必须有不同协议规定电子邮件、网页、FTP数据的格式，这些应用程序协议就构成了”应用层”。
  
  * DNS解析： 它作为将域名和IP地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。
   
    网络中的数据包，是通过“端口号+IP地址+MAC地址”来识别目的地址的，我们输入www.google.com并按下回车的时候，本机服务器先是请求DNS服务器，DNS服务器根据我们发送的域名，根据DNS协议，解析成该域名对应的IP地址并返回给本机，这样，我们就可以进行下面几层的地址封装了
  * 报文：网络中交换与传输的数据单元,即站点一次性要发送的数据块。如HTTP请求报文和HTTP响应报文。


## 2、运输层
### 1、讲一下TCP的连接和释放连接。
三次握手、四次挥手
### 2、TCP有哪些应用场景
### 3、tcp为什么可靠？拥塞控制？流量控制？

[为什么说 TCP 协议是可靠的？](https://www.itcodemonkey.com/article/6617.html)

**ACK回复：**

在每收到一个正确的、符合次序的片段之后，就向发送方(也就是连接的另一段)发送一个特殊的 TCP 片段，用来知会(ACK，acknowledge)发送方：我已经收到那个片段了。这个特殊的 TCP片段 叫做 ACK 回复。如果一个片段序号为 L，对应ACK 回复有回复号 L+1，也就是接收方期待接收的下一个发送片段的序号。

TCP 协议为了减少了 ACK 回复所消耗的流量，采用的是累计ACK回复。

**重新发送机制：**

如果发送方在一定时间等待之后，还是没有收到 ACK 回复，那么它推断之前发送的片段一定发生了异常。发送方会重复发送(retransmit)那个出现异常的片段，等待 ACK 回复，如果还没有收到，那么再重复发送原片段… 直到收到该片段对应的 ACK 回复(回复号为 L+1 的 ACK)

**流量控制：**

TCP采用大小可变的滑动窗口进行流量控制，窗口大小的单位是字节。
发送窗口在连接建立时由双方商定。但在通信的过程中，接收端可根据自己的资源情况，随时动态地调整对方的发送窗口上限值(可增大或减小)。

为什么要设置窗口？
我们可以把窗口理解为缓冲区（但是有些窗口和缓冲区又不太一样）。
如果没有这些“窗口”，那么TCP每发送一段数据后都必须等到接收端确认后才能发送下一段数据，这样做的话TCP传输的效率实在是太低了。解决的办法就是在发送端等待确认的时候继续发送数据。


**拥塞控制：**

TCP通过一个定时器（timer）采样了RTT并计算RTO，但是，如果网络上的延时突然增加，那么，TCP对这个事做出的应对只有重传数据，然而重传会导致网络的负担更重，于是会导致更大的延迟以及更多的丢包，这就导致了恶性循环，最终形成“网络风暴”。 

TCP的拥塞控制机制就是用于应对这种情况，为了在发送端调节所要发送的数据量，定义了一个“拥塞窗口”（Congestion Window），在发送数据时，将拥塞窗口的大小与接收端ack的窗口大小做比较，取较小者作为发送数据量的上限。 

拥塞控制主要是四个算法： 
1. 慢启动：意思是刚刚加入网络的连接，一点一点地提速，不要一上来就把路占满。
2. 拥塞避免：当拥塞窗口cwnd 达到一个阈值时，窗口大小不再呈指数上升，而是以线性上升，避免增长过快导致网络拥塞。 
3. 进入慢启动过程：在收到3个duplicate ACK时就开启重传，而不用等到RTO超时。
4. 快速恢复：至少收到了3个Duplicated Acks，说明网络也不那么糟糕，可以快速恢复。 

* RTT：一个连接的往返时间，即数据发送时刻到接收到确认的时刻的差值；
* RTO：重传超时时间，即从数据发送时刻算起，超过这个时间便执行重传。 

### 4、tcp为什么要建立连接
### 5、阐述https三次握手，4次挥手，为什么是三次握手？

* 建立连接协议，三次握手：

1. 第一次握手：建立连接时，客户端发送syn包（syn=j）到服务器，并进入SYN_SENT状态，等待服务器确认；SYN表示同步序列编号（Synchronize Sequence Numbers）;
2. 第二次握手：服务器收到syn包，必须确认客户的SYN（ack=j+1），同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入SYN_RECV状态；
3. 第三次握手：客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK(ack=k+1），此包发送完毕，客户端和服务器进入ESTABLISHED（TCP连接成功）状态，完成三次握手
![](https://img-blog.csdn.net/20180717202520531?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4OTUwMzE2/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

* 连接终止协议，四次挥手：

1. 首先，客户端发送一个FIN，用来关闭客户端到服务器的数据传送，然后等待服务器的确认。其中终止标志位FIN=1，序列号seq=u；
2. 服务器收到这个FIN，它发送一个ACK，确认ack为收到的序号加一；
3. 关闭服务器到客户端的连接，服务器发送一个FIN给客户端；、
4. 客户端收到FIN后，并发回一个ACK报文确认，并将确认序号seq设置为收到序号加一。首先进行关闭的一方将执行主动关闭，而另一方执行被动关闭。

* 三次握手原因：

    客户端和服务端通信前要进行连接，“三次握手”的作用就是双方都能明确自己和对方的收、发能力是正常的。

    第一次握手：客户端发送网络包，服务端收到了。这样服务端就能得出结论：客户端的发送能力、服务端的接收能力是正常的。

    第二次握手：服务端发包，客户端收到了。这样客户端就能得出结论：服务端的接收、发送能力，客户端的接收、发送能力是正常的。
    
    第一、二次握手后，服务端并不知道客户端的接收能力以及自己的发送能力是否正常
    
    四次握手的话最后一次纯属浪费资源
    
* 为什么连接的时候是三次，关闭的时候却是四次？
   
  因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。
  
  但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，所以只能先回复一个ACK报文，告诉Client端，"你发的FIN报文我收到了"。只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四步握手。




### 6、讲一下浏览器从接收到一个URL到最后展示出页面，经历了哪些过程。

1. DNS域名解析 
2. 建立TCP连接 
3. 发送HTTP请求 
4. 服务器处理请求 
5. 返回响应结果 
6. 关闭TCP连接 
7. 浏览器解析渲染页面

### 7、http和https的区别

1. HTTP是超文本传输协议，信息是明文传输，HTTPS则是具有安全性的SSL加密传输协议；
2. HTTP和HTTPS使用的是完全不同的连接方式，使用的端口也不一样，http是80，https时443，
3. http是无状态的连接，https是SSL+HTTP协议构建的可进行加密传输，比HTTP协议安全。

### 8、https和tls机制，非对称加密，为什么tls要使用非对称加密？这里面有对称加密吗？

[参考网址1](https://www.jianshu.com/p/090cadf02d4e)

[参考网址2](https://juejin.im/post/5a2fbe1b51882507ae25f991#heading-9)

在对称加密中，相同的密钥用于加密和解密，一旦该密钥被盗，所有数据都将消失，因此TLS要使用非对称加密。通过非对称加密技术，客户端和服务器生成一个对称加密的密钥，之后的通讯便是用这一套密钥进行的，此过程是对称加密。

**对称加密：**

加密和解密都用一个密钥。优点是速度快；缺点是密钥容易被截获，不够安全。

**非对称加密：**

有一对密钥，即有公钥也有私钥。公钥随便发，私钥不会发出去，各自保管，用一个加密的话，解密就只能用另外一个。优点是非常安全；缺点是消耗资源，速度极慢，所以要有限使用。不能无节制使用。


**https机制：**

客户端和服务器端通过协商机制得到一个对称加密算法，就此双方使用该算法进行加密解密。从而解决了客户端与服务器端之间的通信安全问题。

* 协商机制采用非对称加密保证安全
* 使用数字证书签发机构颁发的证书来保证非对称加密过程本身的安全
* 之后使用对称加密、解密传输数据

**SSL/TLS协议：**

* 概念：

  SSL“安全套接层”协议，TLS“安全传输层”协议，都属于是加密协议，在其网络数据传输中起到保护隐私和数据的完整性

* 作用：

 1. 认证用户和服务器，确保数据发送到正确的客户机和服务器；
 2. 加密数据以防止数据中途被窃取；
 3. 维护数据的完整性，确保数据在传输过程中不被改变。

* 流程：

1. 双方协商交互参数
2. 双方交换并验证证书
3. 双方生成主密钥
4. 完成握手并开始交互

* 详细流程：

1. 客户端首先发起clientHello消息。包含一个客户端随机生成的random1 数字，客户端支持的加密算法，以及SSL信息；
2. 服务器收到客户端的clientHello消息以后，取出客户端法发来的random1数字，并且取出客户端发来的支持的加密算法， 然后选出一个加密算法，并生成一个随机数random2，发送给客户端serverhello；
3. 服务端通过将自己的公钥通过数字证书的方式发送给客户端，客户端对服务器进行身份校验；
4. 客户端收到服务端传来的证书后，先从 CA 验证该证书的合法性，验证通过后取出证书中的服务端公钥，再生成一个随机数 Random3，再用服务端公钥非对称加密 Random3 生成 PreMaster Key。并将PreMaster Key发送到服务端，服务端通过私钥将PreMaster Key解密获取到Random3,此时客户端和服务器都持有三个随机数Random1 Random2 Random3，双方在通过这三个随机数生成一个对称加密的密钥。双方根据这三个随机数经过相同的算法生成一个密钥，而以后应用层传输的数据都使用这套密钥进行加密。
5. Change Cipher Spec:告诉客户端以后的通讯都使用这一套密钥来进行。


### 8、http的请求有哪些，应答码502和504有什么区别
### 9、http1.1和1.0的区别

1.默认支持长连接;
2.带宽优化，并支持断点续传；
3.新增例如ETag，If-None-Match等更多的缓存控制策略;
4.Host头域;
5.新增了24个错误状态响应码，如409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除；


### 10、304状态码有什么含义？

304(未修改)自从上次请求后，请求的网页未修改过。表示此请求的本地缓存是最新的，可以直接使用。这种方法可以节省带宽，避免重复响应。

### 11、TCP和UDP的区别
1. TCP面向连接,UDP是无连接的，即发送数据之前不需要建立连接；
2. TCP提供可靠的服务，UDP不保证可靠交付；
3. UDP具有较好的实时性，工作效率比TCP高，适用于对高速传输和实时性有较高的通信或广播通信；
4. 每一条TCP连接只能是点到点的;UDP支持一对一，一对多，多对一和多对多的交互通信
5. TCP对系统资源要求较多，UDP对系统资源要求较少。

### 12、长连接、短连接，

[HTTP长连接、短连接究竟是什么？](https://www.cnblogs.com/gotodsp/p/6366163.html)

**短连接**

在HTTP/1.0中默认使用短连接。也就是说，客户端和服务器每进行一次HTTP操作，就建立一次连接，任务结束就中断连接。当客户端浏览器访问的某个HTML或其他类型的Web页中包含有其他的Web资源（如JavaScript文件、图像文件、CSS文件等），每遇到这样一个Web资源，浏览器就会重新建立一个HTTP会话。

**长连接**

而从HTTP/1.1起，默认使用长连接，用以保持连接特性。使用长连接的HTTP协议，会在响应头加入这行代码：

```
Connection:keep-alive
```

在使用长连接的情况下，当一个网页打开完成后，客户端和服务器之间用于传输HTTP数据的TCP连接不会关闭，客户端再次访问这个服务器时，会继续使用这一条已经建立的连接。Keep-Alive不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。实现长连接需要客户端和服务端都支持长连接。

HTTP协议的长连接和短连接，实质上是TCP协议的长连接和短连接。


## 3、网络层
### 1、arp协议，arp攻击
### 2、icmp协议
### 3、讲一下路由器和交换机的区别？

## 4、应用层
### 1、DNS寻址过程
### 2、负载均衡反向代理模式优点及缺点
